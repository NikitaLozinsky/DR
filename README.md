# Диагностика диабетической ретинопатии с помощью машинного обучения

Этот проект направлен на автоматическое обнаружение диабетической ретинопатии (DR) на изображениях глазного дна с использованием методов машинного обучения.

## Структура проекта

```md
├── dataset/ # Данные (изображения и CSV-файлы)
│ ├── images/ # Датасет изображений 
│ │ ├── 0/ # Здоровые глаза - нет DR
│ │ ├── 1/ # Больные глаза (с признаками диабетической ретинопатии) - есть DR
├── results/ # Результаты работы (графики, метрики)
├── src/ # Исходный код
│ ├── pipeline.py # Главный скрипт пайплайна
│ ├── create_csv.py # Создание CSV-файла с метками
│ ├── preprocess_images.py # Обработка изображений и извлечение признаков
│ ├── prepare_data.py # Подготовка данных для обучения
│ ├── train_model.py # Обучение модели машинного обучения
│ ├── run_pipeline.py # Запуск пайплайна
│ └── run_diagnosis.py # Интерактивный режим диагностики
├── config.py # 
├── requirements.txt # Зависимости проекта
└── README.md # Документация
```

## Как пользоваться

*   **Полный ML-пайплайн**: Единый скрипт (`pipeline.py`) для обработки данных, извлечения признаков и обучения модели.

Порядок выполнения скриптов:

1. **create_csv.py** - создает CSV-файл с метками данных. Он сканирует папки с изображениями (с подпапками 0 и 1 для здоровых и больных изображений соответственно) и генерирует файл `label.csv` с именами файлов и соответствующими метками.

2. **preprocess_images.py** - обрабатывает изображения и извлекает признаки. Для каждого изображения вычисляются различные признаки (яркость, контраст, наличие микроаневризм, экссудатов и т.д.) и сохраняются в файл `enhanced_retinopathy_features.csv`.

3. **prepare_data.py** - подготавливает данные для обучения. Загружает извлеченные признаки, анализирует их важность, разделяет данные на обучающую и тестовую выборки и сохраняет их в соответствующие CSV-файлы.

4. **train_model.py** - обучает модель машинного обучения. Использует несколько алгоритмов (логистическая регрессия, случайный лес, градиентный бустинг) и выбирает лучшую модель на основе точности. Сохраняет лучшую модель и масштабатор в папку `results`.

5. **run_diagnosis.py** - запускает интерактивный режим диагностики. Позволяет пользователю вводить пути к изображениям для анализа и получать предсказания о наличии диабетической ретинопатии.



## Немного теории

Диабетическая ретинопатия — это осложнение диабета, которое поражает глаза. Оно вызывается повреждением кровеносных сосудов светочувствительной ткани сетчатки. Для диагностики используются изображения глазного дна, на которых можно обнаружить следующие признаки:

- Микроаневризмы: маленькие красные точки, которые являются ранним признаком.
- Кровоизлияния: пятна крови, которые могут быть точечными или пятнистыми.
- Экссудаты: желтые отложения липидов.
- Неоваскуляризация: рост новых кровеносных сосудов, которые являются хрупкими и могут легко кровоточить.

В этом проекте мы используем классические методы машинного обучения (а не глубокое обучение) для извлечения hand-crafted признаков из изображений. Эти признаки затем используются для обучения модели классификации.

### Используемые признаки

- **Статистические признаки изображения**: средняя яркость и стандартное отклонение яркости.
- **Морфологические признаки**: количество микроаневризм, площадь экссудатов, длина сосудов.
- **Текстуры**: признаки LBP (Local Binary Patterns), энтропия, градиенты.

Модель обучается на этих признаках и может классифицировать новые изображения как здоровые или с признаками ретинопатии.

## Репозиторий

Проект размещен на GitHub: [https://github.com/NikitaLozinsky/DR](https://github.com/NikitaLozinsky/DR)

## Требования

Для запуска проекта необходимы следующие библиотеки Python:

- pandas
- numpy
- scikit-learn
- opencv-python
- scikit-image
- matplotlib
- seaborn
- tqdm

Установите их с помощью pip:

```bash
pip install pandas numpy scikit-learn opencv-python scikit-image matplotlib seaborn tqdm

#или 

pip install -r requirements.txt

```

